<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Simple Soundboard</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <script src="./src/js/jquery-3.3.1.min.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4"
        crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="./src/css/bttn.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/balloon-css/0.5.0/balloon.min.css">
    <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAANCAIAAAAAAA4w7QBrZFwAWVlKAA8PDgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAERAREQEREBEREQABAQABEREREAAAABEREREREAARERERERETIxERERERERVVERERERERBQUBERERERAwMDARERERFQRUABEREREVQEBAERERERUEBAARERERFUBAQBEREREVBAQAERERERVFRUARERERFQQEABERERERVVABERHvewAA8UcAAPgPAAD+PwAA/j8AAP4/AAD8HwAA+A8AAPgPAAD4DwAA+A8AAPgPAAD4DwAA+A8AAPgPAAD8HwAA"
        rel="icon" type="image/x-icon" />
</head>

<body>
    <nav id="topNav" class="navbar navbar-expand-md bg-dark navbar-dark fixed-top">
        <a class="navbar-brand text-white" href="/">Simple Soundboard</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
            <span class="navbar-toggler-icon"></span>
        </button>
    </nav>

    <div id="soundboard" style="padding-top:50px">
    </div>

    <script type="text/javascript">
        var sounds = [];

        $.ajax({
            url: "./src/json/neil-rogers-show-soundboard.json", // Add link to your JSON file here
            dataType: "json",
            type: "get",
            cache: false,
            success: function (data) {
                $(data.files).each(function (index, value) {
                    // name includes name of audio track (audioName) 
                    // and artist if available (artistName)
                    var name = value.name.split(" - ");
                    var audioName = name[0];
                    var artistName = name[1];
                    if (artistName === undefined) {
                        artistName = "";
                    }
                    var thisSound = {
                        audioName: audioName,
                        artistName: artistName,
                        mp3: value.mp3
                    };
                    sounds.push(thisSound);
                })
            }
        }).done(function () {
            sounds.map(file => {
                $('#soundboard').append(function () {
                    var thisAudio = $('<audio/>').attr({
                        src: file.mp3,
                        preload: "auto",
                        onplay: "$(this).siblings('button').removeClass('bttn-primary').addClass('bttn-danger');",
                        onended: "$(this).siblings('button').removeClass('bttn-danger').addClass('bttn-success');"
                        // onplay: "$(this).siblings('button').css('color', 'yellow');",
                        //  onended: "$(this).siblings('button').css('color', 'white');"
                    });
                    var thisButton;
                    file.audioName = file.audioName.substring(0, 35);
                    if (file.artistName !== "") {
                        thisButton = $('<button />')
                            .attr('data-toggle', 'tooltip')
                            .attr('data-placement', 'bottom')
                            .attr('title', file.artistName).addClass('bttn-gradient bttn-md bttn-primary').text(file.audioName);
                    } else {
                        thisButton = $('<button />').addClass('bttn-gradient bttn-md bttn-primary').text(file.audioName);
                    }

                    return $('<span />').addClass('track').append(thisAudio).append(thisButton);
                });
            });
            $('#soundboard').on('click', 'button', function () {
                $(this).siblings('audio').get(0).play();
            });
        });

    </script>


</body>

</html>